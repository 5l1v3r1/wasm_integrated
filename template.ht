<HTML>
<HEAD>
<META charset="UTF-8">
<SCRIPT>

function onLoad()
{
	var g_wa;
	var memory_bytes; //Actually a UInt8Array of the memory object.
	function GetStringAt( memory_address ) { memory_address |= 0; var ret = ""; var ch = 0|0; for( var v = memory_address; ch = memory_bytes[v]; v++ ) ret += String.fromCharCode(ch); return ret; }

	var wasmblob = atob( "\
%WASMBLOB%
	");

	var array = new Uint8Array(new ArrayBuffer(wasmblob.length));
	for(i = 0; i < wasmblob.length; i++) {
		array[i] = wasmblob.charCodeAt(i);
	}

	var imports = {
		env : {
			writeout: function( arg ) { document.getElementById( "docdiv" ).innerHTML = arg; },
			writeoutStr: function( arg ) {document.getElementById( "docdivStr" ).innerHTML = GetStringAt(arg); },
		}
	};


	WebAssembly.instantiate( array, imports ).then( 
		function(wa) {
			g_wa = wa;
			memory_bytes = new Uint8Array(g_wa.instance.exports.memory.buffer);
			console.log( wa );
			console.log( wa.instance.exports.add2( 3, 4) );
			console.log( wa.instance.exports.testcallback( 9 ) );
			console.log( wa.instance );
		}
	);

}

</SCRIPT>
</HEAD>
<BODY onLoad=onLoad()>

Body (This is pure HTML)

<BR><BR>

<DIV ID=docdiv>This is a div.  It should be replaced.</DIV>
<DIV ID=docdivStr>This is a div for string.  It should be replaced.</DIV>

</BODY>
</HTML>

